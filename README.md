# Forward Euler Method in Lean 4

[![Lean Action CI](https://github.com/Vilin97/forward_euler/actions/workflows/lean_action_ci.yml/badge.svg)](https://github.com/Vilin97/forward_euler/actions/workflows/lean_action_ci.yml)
[![Compile blueprint](https://github.com/Vilin97/forward_euler/actions/workflows/blueprint.yml/badge.svg)](https://github.com/Vilin97/forward_euler/actions/workflows/blueprint.yml)

A formal proof of convergence of the [forward Euler method](https://en.wikipedia.org/wiki/Euler_method) for ordinary differential equations.

Given an ODE $y'(t) = v(t, y(t))$, $y(t_0) = y_0$, where $v \colon \mathbb{R} \times E \to E$ is a vector field on a normed space $E$, we define the Euler approximation and prove that it converges to the true solution as the step size $h \to 0^+$.

## Documentation

- [Blueprint](https://vilin97.github.io/forward_euler/blueprint/) -- mathematical blueprint of definitions and theorems
- [Blueprint (PDF)](https://vilin97.github.io/forward_euler/blueprint.pdf)
- [Dependency graph](https://vilin97.github.io/forward_euler/blueprint/dep_graph_document.html)
- [Doc pages](https://vilin97.github.io/forward_euler/docs/)

## Main results

### Definitions

| Definition | Description |
| --- | --- |
| `eulerStep` | A single step: $y_{n+1} = y_n + h \cdot v(t_n, y_n)$ |
| `eulerPoint` | The sequence of Euler points, defined recursively |
| `eulerPath` | Piecewise linear interpolation of the Euler points |
| `eulerDeriv` | Piecewise constant right derivative of the Euler path |

### Theorems

| Theorem | Statement |
| --- | --- |
| `eulerPath_grid_point` | $\mathrm{eulerPath}(t_0 + nh) = y_n$ |
| `eulerPath_continuous` | The Euler path is continuous on $[t_0, \infty)$ |
| `eulerPath_hasDerivWithinAt` | The Euler path has right derivative $\mathrm{eulerDeriv}(t)$ at each $t \geq t_0$ |
| `euler_dist_point_path` | $\mathrm{dist}(y_n, \mathrm{eulerPath}(t)) \leq hM$ for $t \in [t_n, t_{n+1})$ |
| `euler_derivative_bound` | $\mathrm{dist}(\mathrm{eulerDeriv}(t), v(t, \mathrm{eulerPath}(t))) \leq h(L + KM)$ |
| `euler_error_bound` | $\mathrm{dist}(\mathrm{eulerPath}(t), \mathrm{sol}(t)) \leq \mathrm{gronwallBound}(0, K, h(L+KM), t - t_0)$ |
| `euler_convergence` | $\mathrm{eulerPath}(v, h, t_0, y_0, t) \to \mathrm{sol}(t)$ as $h \to 0^+$ |

### Assumptions

The convergence proof assumes:

- $v$ is $K$-Lipschitz in $y$ (space) and $L$-Lipschitz in $t$ (time)
- $\|v(t, y)\| \leq M$ for all $t, y$ (bounded vector field)
- The true solution `sol` is continuous on $[t_0, T]$ with the correct initial condition and right derivative

## Acknowledgements

Initial code generated by [Aristotle](https://aristotle.harmonic.fun).
