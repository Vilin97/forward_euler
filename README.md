# Forward Euler Method in Lean 4

[![Lean Action CI](https://github.com/Vilin97/forward_euler/actions/workflows/lean_action_ci.yml/badge.svg)](https://github.com/Vilin97/forward_euler/actions/workflows/lean_action_ci.yml)
[![Compile blueprint](https://github.com/Vilin97/forward_euler/actions/workflows/blueprint.yml/badge.svg)](https://github.com/Vilin97/forward_euler/actions/workflows/blueprint.yml)

A formal proof of convergence of the [forward Euler method](https://en.wikipedia.org/wiki/Euler_method) for ordinary differential equations.

Given an ODE $y'(t) = v(t, y(t))$, $y(t_0) = y_0$, where $v \colon \mathbb{R} \times E \to E$ is a vector field on a normed space $E$, we define the Euler approximation and prove that it converges to the true solution as the step size $h \to 0^+$.

## Documentation

- [Blueprint](https://vilin97.github.io/forward_euler/blueprint/) -- mathematical blueprint of definitions and theorems
- [Blueprint (PDF)](https://vilin97.github.io/forward_euler/blueprint.pdf)
- [Dependency graph](https://vilin97.github.io/forward_euler/blueprint/dep_graph_document.html)
- [Doc pages](https://vilin97.github.io/forward_euler/docs/)

## Main results

### Generic infrastructure (Mathlib-ready)

| Definition / Theorem | Description |
| --- | --- |
| `piecewiseLinear` | Piecewise linear interpolation on a regular grid |
| `piecewiseConst` | Piecewise constant function on a regular grid |
| `locallyFinite_Icc_grid` | The regular grid $[a + nh, a + (n+1)h]$ is locally finite |
| `ContinuousOn.of_Icc_grid` | Cell-wise continuity implies continuity on $[a, \infty)$ |
| `piecewiseLinear_continuousOn` | Piecewise linear interpolation is continuous |
| `piecewiseLinear_hasDerivWithinAt` | Right derivative of piecewise linear interpolation is the piecewise constant slope |

### Euler method definitions

| Definition | Description |
| --- | --- |
| `ODE.EulerMethod.step` | A single step: $y_{n+1} = y_n + h \cdot v(t_n, y_n)$ |
| `ODE.EulerMethod.point` | The sequence of Euler points, defined recursively |
| `ODE.EulerMethod.slope` | The slope $v(t_n, y_n)$ on the $n$-th cell |
| `ODE.EulerMethod.path` | Piecewise linear interpolation of the Euler points |
| `ODE.EulerMethod.deriv` | Piecewise constant right derivative of the Euler path |

### Theorems

| Theorem | Statement |
| --- | --- |
| `ODE.EulerMethod.dist_deriv_le` | $\mathrm{dist}(\mathrm{deriv}(t), v(t, \mathrm{path}(t))) \leq h(L + KM)$ |
| `ODE.EulerMethod.dist_path_le` | $\mathrm{dist}(\mathrm{path}(t), \mathrm{sol}(t)) \leq \mathrm{gronwallBound}(0, K, h(L+KM), t - t_0)$ |
| `ODE.EulerMethod.tendsto_path` | $\mathrm{path}(v, h, t_0, y_0, t) \to \mathrm{sol}(t)$ as $h \to 0^+$ |

### Assumptions

The convergence proof assumes:

- $v$ is $K$-Lipschitz in $y$ (space) and $L$-Lipschitz in $t$ (time)
- $\|v(t, y)\| \leq M$ for all $t, y$ (bounded vector field)
- The true solution `sol` is continuous on $[t_0, T]$ with the correct initial condition and right derivative

## Acknowledgements

Initial code generated by [Aristotle](https://aristotle.harmonic.fun).
